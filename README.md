# Crypto Wallet

![](assets/cryptocurrency.gif)  
<sub>"Cryptocurrency" by James Ward, *https://dribbble.com/shots/4822394-Cryptocurrency*</sub>

# Criteria A: Planning

## Problem definition
Ms. Sato is a local trader who is interested in the emerging market of cryptocurrencies. She has started to buy and sell electronic currencies, however at the moment she is tracking all her transaction using a ledger in a spreadsheet which is starting to become burdensome and too disorganized. It is also difficult for Ms. Sato to find past transactions or important statistics about the currency. Ms. Sato is in need of a digital ledger that helps her track the amount of the cryptocurrency, the transactions, along with useful statistics. 

Apart for these requirements, Ms. Sato is open to explore a cryptocurrency selected by the developer.

An example of the data stored is 

| Date | Description | Category | Amount  |
|------|-------------|----------|---------|
| Sep 23 2022 | bought a house | Expenses | 10 BTC |
| Sep 24 2022 | food for house celebration | Food | 0.000001 BTC |

## Proposed Solution
I will design and make a digital ledger for Ms. Sato, a client who is in need of a way to track her cryptocurrency transactions. The digital ledger will be about storing data of transactions and generating/displaying statistics, and is constructed using the software Python in the IDE PyCharm. It will take approximately a month to complete and will be evaluated according to the success criteria listed below.

The client has allowed the developer to select a type of cryptocurrency to focus on. Therefore, I picked the currency Dai.

Dai is a cryptocurrency operated by MakerDAO, created in December 2017. Dai aims to bring stability to the cryptocurrency economy as an unbiased, decentralized stablecoin. (“The Maker Protocol: MakerDAO's Multi-Collateral Dai (MCD) System”, makerdao.com, https://makerdao.com/en/whitepaper) 1 Dai is approximately pegged to $1 USD, making it an advantage for users who want to avoid the high volatility of cryptocurrencies such as Bitcoin, or Ethereum. Dai can be generated by depositing collateral assets into Maker Vaults in the Maker Protocol, which creates liquidity for users. Being run by an Decentralized Autonomous Organization, there is no central government. This can be an advantage for users who prefer to trust democratic governance for financial systems. All Dai transactions can also be publicly viewed on the Ethereum blockchain, promoting transparency for the currency. (“What Is DAI Coin and Why Is It Special?”, originstamp.com, https://originstamp.com/blog/what-is-dai-coin-and-why-is-it-special/) Overall, Dai is a cryptocurrency valued for its high stability, freedom, and transparency.

I will be making the digital ledger using Python. First, the readability of Python's due to its simple syntax makes maintenance and updates to the ledger easy, and minimal-cost. The reusability of code in Python would make the creation of new, but similar or improved functions efficient. Secondly, Python’s support of modules, packages, and libraries help simplify complicated functions that can be useful in achieving a desirable ledger for the client. Some examples include datetime to record the date of transactions, csv to store these transactions in a database, pandas to analyze data, and maskpass to hide password inputs in the terminal. (“What is Python? Executive Summary”, python.org, https://www.python.org/doc/essays/blurb/)

## Success Criteria
1. The electronic ledger is a text-based software (Runs in the Terminal).
2. The electronic ledger display the basic description of the cyrptocurrency selected. 
3. The electronic ledger allows to enter, withdraw and record transactions.
4. The electronic ledger can display statistics such as profit, total spendings, total earnings, and balance.
5. The electronic ledger organizes transactions based on categories such as "Expenses," "Food," "Clothes," etc.
6. The electronic ledger can display all transactions made in a specified month of a specified year.

Success criterias 1, 2, and 3 are pre-determined success criterias as per the client's request.

Success criteria 4 is relevant to the client's needs, as in the problem definition, it is stated that "Ms. Sato is in need of a digital ledger that helps her track the amount of the cryptocurrency, the transactions, along with useful statistics." I interpreted useful statistics as data such as incomes, expenditures, total gain, and total loss. It is also stated she needs to track the amount of cryptocurrency, therefore the current balance she has is another statistic that should be displayed.

Success criteria 5 is relevant to the client's needs as in the problem definition, an exmple of how the client has been storing data is shared. Currently, the client is storing data on each transaction in the format of date, description, category, and amount. Therefore, to make it easier for the client to adapt to using my application, my digital ledger should be able to categorize the client's transactions into similar sorts of categories.

Success criteria 6 is relevant to the client's needs, as in the problem definition, it is stated that it is "difficult for Ms. Sato to find past transactions." Therefore, a feature that easily locates and display past transactions would be a useful feature for the client. Many people tend to finance their money by month, therefore I chose that the ledger should be able to display all transactions from a specified month in a specified year.

Although a feature that can calculate the rate of Dai to the USD can be useful, it is not as important as other features due to the nature of Dai being soft-pegged to the value of USD. As the difference in the value of 1 Dai and $1 USD is at any time practically negligible, a calculation is barely ever required.       


# Criteria B: Design

## System Diagram
![](assets/unit1_system_diagram.jpg)
*Fig.1* System diagram of proposed solution

## Flow Diagrams
![]()

## Record of Tasks
| Task No | Planned Action                     | Planned Outcome                                                                                             | Time estimate (min) | Target completion date | Criterion |
|---------|------------------------------------|-------------------------------------------------------------------------------------------------------------|---------------------|------------------------|-----------|
| 1       | Create system diagram              | To have a clear idea of the hardware and software requirements for the proposed solution                    | 10                  | Sep 13                 | B         |
| 2       | Create a login system              | To have a flow diagram and the code for the login system                                                    | 30                  | Sep 14                 | B, C      |
| 3       | Finalize Success Criteria          | To have a finalized success criteria, where its relevance to the client's needs are justified               | 30                  | Sep 18                 | A         |
| 4       | Create a display menu function     | To have a function that can display a menu of choices the user can make, given the choices                  | 10                  | Sep 22                 | C         |
| 5       | Create a validate choice function  | To have a function that can validate user input of their selected choice in the menu                        | 10                  | Sep 22                 | C         |
| 6       | Create a new user system           | To have a code that allows for new users to be created                                                      | 20                  | Sep 25                 | C         |
| 7       | Create a new transaction function  | To have a function that allows for the user to record a new transaction in their own csv file               | 30                  | Sep 25                 | C         |
| 8       | Display basic statistics           | To have a code that displays basic statistics such as total profit, loss, balance, debt                     | 20                  | Sep 25                 | C         |
| 9       | Display currency description       | To have a code that displays the description of the cryptocurrency selected                                 | 5                   | Sep 27                 | C         |
| 10      | Update new transaction function    | To allow for the user to sort any withdrawal (expenditure) transaction into a chosen category               | 20                  | Sep 27                 | C         |
| 11      | Create a obtain data function      | To have a function that obtains transaction data from the user's csv file for use                           | 40                  | Sep 28                 | C         |
| 12      | Create a display chart function    | To have a function that displays a basic bar graph of a specified category of data                          | 30                  | Sep 28                 | C         |
| 13      | Create a loop for wallet functions | To make it so that the program does not exit, and can repeat functions specified by user until they log-out | 15                  | Sep 29                 | C         |
| 14      | Receive peer feedback              | To have received peer feedback and identify issues/improvements that could be made                          | 70                  | Sep 29                 | B, C      |
| 15      | Finalize code                      | Addressed all tasks identified in peer feedback session                                                     | 240                 | Sep 30                 | C         |
| 15      | Repeat all tests                   | To have confirmed that the program passes all tests recorded in the Test Plan                               | 30                  | Oct 1                  | B         |

## Test Plan
| Test Type   | Test Content                                       | Input                                                                                                                                       | Expected Output                                                                                                                                                                                                                  |
|-------------|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Integration | Create User and Log-in                             | 1. Run the program 2. Select 2 at startup menu 3. Input "Robert1" and "passw0rd" 4. When log-in is prompted, input "Robert1" and "passw0rd" | Last line in users.csv is "Robert,passw0rd" A new csv file of the name Robert.csv is created First line in Robert1.csv is "(date),0,other" "Welcome to your walllet!" should be printed, along with the main menu                |
| Unit        | Create New Deposit                                 | After above, select 1 at main menu Select 1 at transaction menu Input "123.45"                                                              | The most recent line in the Robert1.csv file should be "(date),123.45,deposit"                                                                                                                                                   |
| Unit        | Create New Withdrawal                              | After above, select 1 at return menu Select 1 at main menu Select 2 at transaction menu Input "23.45" Select 5 at categories menu           | The most recent line in the Robert1.csv file should be "(date),-23.45,other"                                                                                                                                                     |
| Integration | Create New Transactions and View Past Transactions | After above, select 1 at return menu Select 2 at main menu Input 2023 for year, (the month of testing) for month                            | The terminal should display: [All Transactions from 2023/(month)] [Date, Amount, Category] (date), 0, other (date) '123.45, deposit (date), -23.45, other This should reflect the lines written in Robert1.csv                   |
| Unit        | View User Statistics page 1                        | After above, select 1 at return menu Select 3 at main menu                                                                                  | The terminal should display the first page of statistics: User creation date, current balance, debt state Total profit, total loss, profit/loss ratio Bar graph to total profit and loss Menu to ask to go to next page, or exit |
| Unit        | View User Statistics page 2                        | After above, select 1 for next page menu Input 2023 for year, (the month of testing) for month                                              | The terminal should display the second page of statistics: Bar graph for profit/loss of the month Bar graph for expenses by category of the month Menu to ask to go to next page, or exit                                        |
| Unit        | View cryptocurrency description                    | After above, select 2 for next page menu Select 1 at return menu Select 4 at main menu                                                      | The terminal should display a text of description for the DAI currency                                                                                                                                                           |
| Unit        | Log-out from return? menu                          | After above, select 2 for return menu                                                                                                       | The program should exit with exit code 0.                                                                                                                                                                                        |
| System      | The above unit tests run continuously              | -                                                                                                                                           | The program should run from start to finish without producing errors.                                                                                                                                                            |
| Integration | Log-in from log-in menu and Log-out from main menu | Run the program Select 1 at startup menu Input Robert1 and passw0rd Select 5 at main menu                                                   | "[Welcome to your wallet]" should be printed, followed by the main menu When 5 is selected, the code should exit with exit code 1.                                                                                               |
| Usability   | General ease and clarity of use                    | Let a random peer who is unfamiliar with the project use the program.                                                                       | Program should not produce any errors. Ideally, the tester does not have to ask anything for clarification.                                                                                                                      |

# Criteria C: Development
## Displaying a menu, and validating a user choice from the menu
To provide the user with a clear and legible interface to show the various options available, I chose to use functions. To create this, I first made a function using a for loop that will print a simple menu.
```.py
def display_menu(choices: list):
    """Displays a menu with choices from a list.
    :param choices: list containing strings of choices in a menu
    """

    menu = ''
    count = 1
    for it in choices:
        menu += f"{it.ljust(50, '.')} type {count}\n"
        count += 1
    print(menu)
```
In the first line of code, I define the function display_menu, which takes a list choices as a parameter. In the next line, a new empty string is stored as the variable menu. In the next line, A variable count is also created, which counts the number of options the menu will display. Next, the list choices is looped through each item in a for loop. Each of the item in choices are options to be displayed to the user. For each loop, an f-string to be printed is added to menu, and count is incremented by 1. Once the for loop has looped through every item in the list, it will print the menu variable which contains a menu of each of the options available to the user.

Next, I created a second function which validates user inputs from when they choose an option on the menu. This was done using a combination of if statements to check for specific conditions, and a while loop that will continue until the inputs meet the conditions.
```.py
def validate_selection(choices: list) -> int:
    """Takes a list and a int user input, checks if the user input is within the number of choices available in the menu. Returns the int selection.
    :param choices: list
        A list containing strings of choices in a menu
    :return: int
        The final selection of user as an integer corresponding to the choices in list
    """

    expect = len(choices)
    select = input(f'Select a choice between 1~{expect}: ')
    while not select.isnumeric():
        select = input(f"Error. Please select a choice between 1~{expect}: ")
    while True:
        if not select.isnumeric() or not 0 < int(select) < expect + 1:
            select = input(f"Error. Please select a choice between 1~{expect}: ")
        else:
            break
    select = int(select)
    return select
```
In the first line, I define the function validate_selection, which takes a list choices as a parameter, and returns an integer. In the next line, the variable expect representing the range of numbers the program is expecting is initialized. expect is the length of the list of choices, as the program expects a choice between the first option in the list and the last option in the list. In the next line, a variable select, stores the user's selection. The program then checks using a while loop if select is a numeric value, or if the integer value of select is within the expected values. While either is False, the program will keep prompting the user for a new selection until both conditions turn True. Once the if statement is True, it will go to the else statement, breaking the loop. Select is then converted into an integer and returned from the function.

## Create New User Function
It would be beneficial for the client if they can create multiple accounts: this way, they could share with the product their family members, or finance their personal and work expenditures separately. I created this function by using csv files, while loops, and if statements.
```.py
print("[Create New User]")
with open('users.csv', mode='r') as users_list:
    users_database = users_list.readlines()
new_name = input("Create an alphanumeric username: ")
while not new_name.isalnum():
    new_name = input("Error. Please enter a username that is alphanumeric: ")
if users_database:  # if users_database is not empty
    validate = True
    while validate:
        for user in users_database:
            if new_name in user:
                new_name = input("Username already taken. Please enter another username: ")
            else:
                validate = False

new_pass = input("Create an alphanumeric password: ")
while not new_pass.isalnum():
    new_pass = input("Error. Please enter a password that is alphanumeric: ")
confirm_new_pass = input("Confirm new password: ")
while True:
    if confirm_new_pass != new_pass:
        new_pass = input("Passwords do not match. Create a password: ")
        confirm_new_pass = input("Confirm new password: ")
    else:
        break

with open('users.csv', mode='a') as users_list:
    writer = csv.writer(users_list)
    writer.writerow([new_name, new_pass])
with open(f"{new_name}.csv", mode='a') as user_data:
    writer = csv.writer(user_data)
    writer.writerow([datetime.date.today(), 0, "other"])
print("New User Successfully Created. Please log-in.")
```
In the first line, a header for the function is printed. In the next line, the open function from the csv module is used to open the file users.csv. mode='r' states that the program will only be reading the contents of the file. Next, I created a variable users_database which stores a list of each line from the csv file. The program then takes a user input to create a username, and stores it in the variable new_name. The program then checks using a while loop that new_name is alphanumeric. While new_name is not alphanumeric, the program will keep asking the user for a new input for new_name. When new_name is alphanumeric, the while loop finishes. In the next line, with an if statement the program checks if users_database contains elements. Should users_database be empty, the program skips the if statement. If the statement is true, a variable validate is set as True. While validate, a for loop loops between each line (user) in users_database. Next, an if statement checks if new_name is in user. If True, the program prompts the user to create a new username and stores it as new_name. If False, validate is switched to False and the for loop ends.

In the next section, the user creates a new password. First, the user creates a new password which is stored as the variable new_pass. Then, using a while loop, the program checks if new_pass is alphanumeric. While new_pass is not alphanumeric, the program will keep asking for an alphanumeric password and stores it in new_pass. The for loop ends when new_pass is alphanumeric. Next, the user confirms their new password. Their input is stored in the variable confirm_new_pass. In a while True loop, I used an if statement to check if new_pass is nit the same as confirm_new_pass. If True, the program takes a new new_pass and confirm_new_pass and loops again. Else, the while loop is broken.

Now all of the required information is provided. I use the csv module again to add this information into the database. Using the open function I open the file users.csv. mode='a' states that the program can append to the file. The function csv.writer() states that the program will now write onto users_list, and writer.writerow() writes the variable new_name and new_pass two comma separated values in a row of the file. Using the same method, I then open a csv file new_name.csv in the same mode='a' as user_data. The program writes a row on the file containing today's date taken from the datetime module, 0 (the amount of DAI the user has), and "other". Finally, a message is printed to present that the program has recorded them as a new user.

## Logging-in to the Wallet
To provide the client with privacy and security, a user should log-in to use the ledger. A function to check if a user has successfully logged-in is suitable for this goal. To create this, I used the csv module, for loops, and if statements. 
```.py
def try_login() -> tuple:
    """Takes user input for username and password, and checks if the username and password is in one line in users.csv. Returns a tuple containing a bool and a str.
    :return: tuple
        A tuple containing a bool and a str. The bool is True if the username and password exist together, and False if the username and password do not match existing data. The str is the username of the user.
    """

    print("[Log-in]")
    with open('users.csv', mode='r') as f:
        data = f.readlines()
    success = False

    in_name = input("Enter your username: ")
    in_pass = input("Enter your password: ")

    for line in data:
        uname = line.split(',')[0]
        upass = line.split(',')[1].strip()  # strip() removes \n for any string unless specified

        if uname == in_name and upass == in_pass:  # user input matches an existing username and corresponding password
            success = True
            break

    return success, uname  #uname of current session user
```
In the first line, I define the function try_login, which returns a tupe containing a boolean and string. In the next line, I print a short header to show the user that they will now be logging in to their account. Next, using the open function from the csv module, I open users.csv which contains the usernames of all of the users registered on the product and the passwords to each of the usernames. The code mode='r' specifies that the program will only read the contents of the file. In the next line, the content of each line is saved as a list in the variable data, using the readlines function. Next, the program will use the data obtained in the previous lines to determine if the user may now log-in to the ledger or not. First, a new variable success, representing whether the current session user has successfully logged into an account or not is stored as a boolean, False. Then, a user input prompting the user for a username is stored as the variable in_name. A user input prompting the user for the corresponding password is stored as the variable in_pass.
Next, I use a for loop to check if the current user can log-in. The for loop loops between every line (string) in data (list) defined above. For every line, using the split function, the program splits the line by ',' and stores the 0 index value as the uname variable, and the 1 index value as the upass variable. (The upass variable needs the strip() function, as it is the end of a line in the csv file, and hence '\n' representing the start of a new line is at the end of the string. The strip() function removes the '\n'.) Then an if statement checks if uname is equal to in_name, and upass is equal to in_pass. When both comparisons are True, success can be switched to True, and the for loop is broken. Otherwise, the program keeps looping through every pre-existing user in the database until the if statement is True, or it loops through every pre-existing user. In the last line, the function finally returns success and the uname as a tuple.

## Validating a Float
As DAI is a currency osft-pegged to the USD which is precise to 2 decimal places, the client should be able to input deposit and withdrawal values to at least 2 decimal places. As a way to check if a value is a float does not exist, I defined a function that will do this for me using exception handling.
```.py
def validate_float(user_input: str) -> bool:
    """Takes a str user input and checks if it is a valid float. Returns a bool.
    :param user_input: str
        The user input to be validated
    :return: bool
        True if user input is a valid float, False if user input is not a valid float
    """

    try:
        float(user_input)
        return True
    except ValueError:
        return False
```
In the first line, the function validate_float is defined. It takes user_input, a string as a parameter and returns a boolean. In the next three lines, I used try to tell the program to check if user_input can be converted to a float. If it is possible, the program returns True. If user_input cannot be converted to a float, it will cause a ValueError. In the next line, I use except ValueError to prevent the program from producing an error and stopping the code, but to return False instead.

## Creating a New Transaction (Success Criteria 3 & 5)
The electronic ledger should allow the user to enter, withdraw and record transactions. Therefore I created a function that allows the user to enter a new transaction to be recorded in the ledger. To achieve this, I used a combination of if statements, while loops, input validations, and the csv module.
```.py
def create_transaction(select: int, name: str, categories: list):
    """Creates a new transaction and adds the transaction to the user's csv file.
    :param select: int
        The user's selection of transaction type
    :param name: str
        The username of the user of the current session
    :param categories: list
        A list containing strings of categories for deposits for the user to select from
    """

    if select == 1:  # User Creates New Transaction
        print("[New Deposit]")
        raw_dep = input("Enter amount of DAI you would like to deposit: ")
        while not validate_float(raw_dep):
            raw_dep = input("Error. Please enter how much DAI you would like to deposit: ")
        action_value = float(raw_dep)
        category = "deposit"
    if select == 2:  # User Creates New Withdrawal
        print("[New Withdrawal]")
        raw_wtd = input("Enter amount of DAI you would like to withdraw: ")
        while not validate_float(raw_wtd):
            raw_wtd = input("Error. Please enter how much DAI you would like to deposit: ")
        action_value = float(raw_wtd)
        print("Select a Category for your Withdrawal:")
        display_menu(categories)
        category = categories[validate_selection(categories)-1].lower()

    with open(f"{name}.csv", mode='a') as user_data:
        user_data.writelines(f"{datetime.date.today()},{action_value},{category}\n")
    print(f"Transaction Recorded: On {datetime.date.today()}, {action_value} DAI as {category} on {name}'s wallet.")
```
In the first line, the function create_transaction is defined. It takes select: an integer, name: a string, and categories: a list, as parameters. In the next line, I use an if statement that checks if the argument given for select is equal to 1. If this is True, in the next line, the program prints a simple heading letting the user know they are creating a new deposit. Next, the program stores a user input for the amount to be deposited in the variable raw_dep. Using a while loop and the previosuly defined function validate_float, I validate raw_dep by checking if it is a value that can be converted to a float. If the validate_float function returns False when taking raw_dep as an argument, a new user_input is stored as raw_dep. The while loop continues until raw_dep can be converted into a float, and the loop ends. In the next line, the variable action_value is created and stores the flaot value of raw_dep. As the user selected to create a deposit, the variable category stores the string "deposit."
In the next line, I use an if statement again that checks if the argument given for select is equal to 2. If this is True, the program prints a simple heading letting the user know they are creating a new withdrawal. In the next line, the variable raw_wtd is created and stores a user input for the amount to be withdrawn. Using the same method as for creating a transaction, a while loop will keep asking the user for a new raw_wtd while raw_wtd cannot be converted to a float. Once the while loop ends, raw_wtd is converted to a float and sotred in the variable action_value. Next, a message is printed to ask the user to choose a category for their withdrawal. Using the display_menu function defined previously, I print a menu using the argument for categories. Then, I call the previously defined validate_selection function to take the user's selection from the menu. The integer returned -1 (as the first item ina  list is index 0) represents the index of the option the user chose. Therefore I store the item at that index in categories as the variable category.
Finally, in the last three lines of code, I use the csv module to open the user's csv file. mode='a' lets the program append to the csv file. The program writes a new line in the file containing the date of the transaction (obtained using the datetime module), the action_value, and the category. The last line prints a message to let the user know that the transaction has been recorded.

## Displaying Past Transactions (Success Criteria 6)
As per success criteria 6: The electronic ledger can display all transactions made in a specified month of a specified year, I created a function that allows for the user to select a month and year and then display all transactions during that period.

## Showing User Statistics (Success Criteria 4)
As per success criteria 4: The electronic ledger can display statistics such as profit, total spendings, total earnings, and balance, I made a program for the terminal to display these statistics to the user.

## Displaying a description of the cyrptocurrency (Success Criteria 2)
As per success criteria 2: The electronic ledger display the basic description of the cyrptocurrency selected, in this section of the program, I coded a way for the user to be able to see the description of the DAI token.
```.py

```

